<!DOCTYPE html>
<html lang="en-us">

  <head>
  <link href="http://gmpg.org/xfn/11" rel="profile">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta http-equiv="content-type" content="text/html; charset=utf-8">

  <!-- Enable responsiveness on mobile devices-->
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1">

  <title>
    
      notification-daemon &middot; Singularity.be
    
  </title>

  <!-- CSS -->
  <link rel="stylesheet" href="/public/css/poole.css">
  <link rel="stylesheet" href="/public/css/syntax.css">
  <link rel="stylesheet" href="/public/css/hyde.css">
  <link rel="stylesheet" href="http://fonts.googleapis.com/css?family=PT+Sans:400,400italic,700|Abril+Fatface">

  <!-- Icons -->
  <link rel="apple-touch-icon-precomposed" sizes="144x144" href="/public/apple-touch-icon-144-precomposed.png">
                                 <link rel="shortcut icon" href="/public/favicon.ico">

  <!-- RSS -->
  <link rel="alternate" type="application/rss+xml" title="RSS" href="/atom.xml">
</head>


  <body>

    <div class="sidebar">
  <div class="container sidebar-sticky">
    <div class="sidebar-about">
      <h1>
        <a href="/">
          Singularity.be
        </a>
      </h1>
      <p class="lead">Steven Van Acker's blog</p>
    </div>

    <nav class="sidebar-nav">
      <a class="sidebar-nav-item" href="/">Home</a>

      

      
      
        
          
        
      
        
          
            <a class="sidebar-nav-item" href="/about/">About</a>
          
        
      
        
          
        
      
        
      
        
          
        
      
        
          
            <a class="sidebar-nav-item" href="/projects/">Projects</a>
          
        
      
        
          
            <a class="sidebar-nav-item" href="/publications/">Publications</a>
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
    </nav>

    <!-- <p>&copy; 2016. All rights reserved.</p> -->
  </div>
</div>


    <div class="content container">
      <div class="post">
  <h1 class="post-title">notification-daemon</h1>
  <span class="post-date">03 Apr 2007</span>
  I was wrong.<br /><br />After looking around some more, I found that there is a notification-daemon package that uses <a href="http://www.freedesktop.org/wiki/Software/dbus">D-BUS</a>.<br /><br />"D-Bus is a message bus system, a simple way for applications to talk to one another."<br /><br />There is libnotify, which is a library to send notifications through D-BUS, and there is libnotify-bin, which contains a tool "notify-send" to send single notifications.<br /><br />There are also Python bindings in python-notify, which can be used to post notifications to D-BUS, through libnotify. Too complicated ? Not really.<br /><br />I was so fixed on creating a "file watching daemon" that would constantly query a file, read new lines and post those as notifications.<br />I decided to create such a daemon using the python bindings, and it actually works nicely.<br /><br /><pre><br />#!/usr/bin/python<br />import time<br />import string<br />import gtk, pynotify<br /><br />pynotify.init("test")<br /><br />TypeImages = { <br />                'info': "icon.png",<br />                'alert': "/usr/share/app-install/icons/blam.png"<br />             }<br />TypeTitles = { <br />                'info': "Informational", <br />                'alert': "Alert"<br />             }<br /><br /><br />fp=open('/tmp/workfile', 'r')<br /><br />lastdate = int(time.time())<br />while 1:<br />    line = fp.readline()<br />    while line:<br />        line = line.rstrip()<br />        parts = line.split(" ", 2)<br />        i = line.find(" ") # let's assume this is not -1<br />        ts = line[0:i]<br />        line = line[i+1:]<br /><br />        i = line.find(" ") # let's assume this is not -1<br />        tag = line[0:i]<br />        rest = line[i+1:]<br /><br />        if lastdate <= int(ts):<br />            #print "[" + ts + "][" + rest + "]"<br />            if TypeTitles.has_key(tag):<br />                n = pynotify.Notification(TypeTitles[tag], rest)<br />                p = gtk.gdk.pixbuf_new_from_file(TypeImages[tag])<br />                n.set_icon_from_pixbuf(p)<br />            else:<br />                n = pynotify.Notification("Unknown", rest)<br />            <br />            n.show()<br /><br />        line = fp.readline()<br /><br />    lastdate = int(time.time())<br />    time.sleep(1)<br /><br />fp.close()<br /></pre><br /><br />This program works nicely, but there is no advantage over calling notify-send manually. Well, not a lot anyway.<br /><br />So instead of creating a new package with this daemon in it, I'll just use notify-send everywhere (or maybe write a wrapper around it)<br /><br />For example:<br /><pre><br />notify-send -i /usr/share/app-install/icons/kalarm.png "Test"<br /></pre>
</div>


    </div>

  </body>
</html>
