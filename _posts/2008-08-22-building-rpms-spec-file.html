---
layout: post
title: 'building RPMs: the spec-file'
date: '2008-08-22T10:11:00.002+02:00'
author: Steven Van Acker
tags:
- English
- Rant
- Fedora
- OverTheWire
- RPM
modified_time: '2008-08-22T10:20:08.089+02:00'
blogger_id: tag:blogger.com,1999:blog-5513234137363262204.post-5509308584534772762
blogger_orig_url: http://www.singularity.be/2008/08/building-rpms-spec-file.html
---

<!-- StevensBlogSpotFilterThing<br />Today I find myself in the need to build an RPM of the "ratbox" ircd, with some patches. To get a headstart, I decided to look around for an existing spec-file and I found one here:<br /><a href="http://ftp.icm.edu.pl/packages/openpkg/sources/SRC/ratbox/ratbox.spec">http://ftp.icm.edu.pl/packages/openpkg/sources/SRC/ratbox/ratbox.spec</a><br /><br />Now, I was under the impression that RPM was some standard and that therefore, a spec-file had some standards as well. The spec-file I downloaded comes from the <a href="http://www.openpkg.org">OpenPKG project</a> and seems to have some non-standard "extensions".<br /><br />First of all, my rpmbuild complains about this line:<br />[PRE]<br />Class:        BASE<br />[/PRE]<br /><br />I removed that line<br /><br />Next, some pre-build dependencies fail<br />[PRE]<br />error: Failed build dependencies:<br /> OpenPKG is needed by ratbox-2.2.8-20080112.i386<br /> openpkg >= 20060823 is needed by ratbox-2.2.8-20080112.i386<br />[/PRE]<br /><br />I removed those dependencies<br /><br />After that, the %prep section fails:<br />[PRE]<br />Executing(%prep): /bin/sh -e /var/tmp/rpm-tmp.26173<br />+ umask 022<br />+ cd /usr/src/redhat/BUILD<br />+ %setup -q -c<br />/var/tmp/rpm-tmp.26173: line 24: fg: no job control<br />error: Bad exit status from /var/tmp/rpm-tmp.26173 (%prep)<br /><br /><br />RPM build errors:<br />    Bad exit status from /var/tmp/rpm-tmp.26173 (%prep)<br />[/PRE]<br /><br />That's apparently because there are spaces in front of "%setup" and friends. I removed them.<br /><br />And now I get:<br />[PRE]<br />error: File /usr/src/redhat/SOURCES/ircd-ratbox-2.2.8.tgz: No such file or directory<br />[/PRE]<br /><br />Right. Quadruple fail. I guess I'll just have to write my own spec file instead.<br />StevensBlogSpotFilterThing --><br />Today I find myself in the need to build an RPM of the "ratbox" ircd, with some patches. To get a headstart, I decided to look around for an existing spec-file and I found one here:<br /><a href="http://ftp.icm.edu.pl/packages/openpkg/sources/SRC/ratbox/ratbox.spec">http://ftp.icm.edu.pl/packages/openpkg/sources/SRC/ratbox/ratbox.spec</a><br /><br />Now, I was under the impression that RPM was some standard and that therefore, a spec-file had some standards as well. The spec-file I downloaded comes from the <a href="http://www.openpkg.org">OpenPKG project</a> and seems to have some non-standard "extensions".<br /><br />First of all, my rpmbuild complains about this line:<br /><pre style="background-color: #EEEEEE; border: black 1px dashed; line-height: 100%; padding: 10px;"><br />Class:        BASE<br /></pre><br /><br />I removed that line<br /><br />Next, some pre-build dependencies fail<br /><pre style="background-color: #EEEEEE; border: black 1px dashed; line-height: 100%; padding: 10px;"><br />error: Failed build dependencies:<br /> OpenPKG is needed by ratbox-2.2.8-20080112.i386<br /> openpkg >= 20060823 is needed by ratbox-2.2.8-20080112.i386<br /></pre><br /><br />I removed those dependencies<br /><br />After that, the %prep section fails:<br /><pre style="background-color: #EEEEEE; border: black 1px dashed; line-height: 100%; padding: 10px;"><br />Executing(%prep): /bin/sh -e /var/tmp/rpm-tmp.26173<br />+ umask 022<br />+ cd /usr/src/redhat/BUILD<br />+ %setup -q -c<br />/var/tmp/rpm-tmp.26173: line 24: fg: no job control<br />error: Bad exit status from /var/tmp/rpm-tmp.26173 (%prep)<br /><br /><br />RPM build errors:<br />    Bad exit status from /var/tmp/rpm-tmp.26173 (%prep)<br /></pre><br /><br />That's apparently because there are spaces in front of "%setup" and friends. I removed them.<br /><br />And now I get:<br /><pre style="background-color: #EEEEEE; border: black 1px dashed; line-height: 100%; padding: 10px;"><br />error: File /usr/src/redhat/SOURCES/ircd-ratbox-2.2.8.tgz: No such file or directory<br /></pre><br /><br />Right. Quadruple fail. I guess I'll just have to write my own spec file instead.