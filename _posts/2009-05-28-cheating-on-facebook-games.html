---
layout: post
title: Cheating on Facebook games
date: '2009-05-28T10:16:00.005+02:00'
author: Steven Van Acker
tags:
- English
modified_time: '2009-05-28T10:39:28.477+02:00'
blogger_id: tag:blogger.com,1999:blog-5513234137363262204.post-4386523648575673319
blogger_orig_url: http://www.singularity.be/2009/05/cheating-on-facebook-games.html
---

<!-- StevensBlogSpotFilterThing<br />I'm really not good at playing Bejeweled Blitz on Facebook.<br />To mess around with my family, I've been cheating pretty much since I played the game the first time. <br /><br />Some of you have been wondering how that is actually possible. While it's not exactly a feat of genius, it does require some working knowledge of how Flash games work.<br /><br />Flash is a client-side plugin that runs a program inside your browser. When you visit a page with a flash game on it, the program is downloaded from a website and executed on your PC. What's important is that the entire thing runs on your PC and then possibly submits a highscore to the gameserver. Nothing prevents you from faking the reply to the gameserver...<br /><br />The data sent to the gameserver can be captured with a network monitor. It would be possible to change the transmitted data "in flight", but I didn't go through the trouble of doing all that and just transmitted a modified copy of the original data.<br /><br />In the case of Bejeweled Blitz, the creators of the game wanted to be smart about it and tried to protect the integrity of the data being sent to the server with a field called "checksum". But it's not really difficult to get around it.<br /><br />You can disassemble the flash game with a "flasm":<br />[PRE]<br />flasm -d bejeweledfacebook.swf<br />[/PRE]<br /><br />The code that generated the checksum is listed here:<br />[PRE]<br />        push 0.0, 'md5'<br />        new<br />        setRegister r:5<br />        pop<br />        push 'checksum', 'myScore'<br />        getVariable<br />        push 'nonivechey902!0'<br />        add<br />        push r:3, 'fb_sig_user'<br />        getMember<br />        add<br />        toString<br />        push 1, r:5, 'hash'<br />        callMethod<br />        setVariable<br />[/PRE]<br /><br />In pseudocode that would read something like:<br />[PRE]<br />checksum = hash(getVariable("myScore") + "nonivechey902!0" + user.getMember("fb_sig_user"), "md5")<br />[/PRE]<br /><br />So, to set my score to 102101 (which is 1 higher than my mom's ;), I generate a new checksum <br />(I used userid 0123456789 in this example)<br /><br />[PRE]<br />deepstar@phoenix:/tmp/bej$ echo -n '102101nonivechey902!00123456789' | md5sum<br />e3f37c9eb8c861818c0e4b32265be59d  -<br />[/PRE]<br /><br />Next, I replaced the checksum in the datastream with the one above, and changed the score to 102101. Finally transmitted it to the gameserver and the score was set.<br /><br />StevensBlogSpotFilterThing --><br />I'm really not good at playing Bejeweled Blitz on Facebook.<br />To mess around with my family, I've been cheating pretty much since I played the game the first time. <br /><br />Some of you have been wondering how that is actually possible. While it's not exactly a feat of genius, it does require some working knowledge of how Flash games work.<br /><br />Flash is a client-side plugin that runs a program inside your browser. When you visit a page with a flash game on it, the program is downloaded from a website and executed on your PC. What's important is that the entire thing runs on your PC and then possibly submits a highscore to the gameserver. Nothing prevents you from faking the reply to the gameserver...<br /><br />The data sent to the gameserver can be captured with a network monitor. It would be possible to change the transmitted data "in flight", but I didn't go through the trouble of doing all that and just transmitted a modified copy of the original data.<br /><br />In the case of Bejeweled Blitz, the creators of the game wanted to be smart about it and tried to protect the integrity of the data being sent to the server with a field called "checksum". But it's not really difficult to get around it.<br /><br />You can disassemble the flash game with a "flasm":<br /><pre style="background-color: #EEEEEE; border: black 1px dashed; line-height: 100%; padding: 10px;"><br />flasm -d bejeweledfacebook.swf<br /></pre><br /><br />The code that generated the checksum is listed here:<br /><pre style="background-color: #EEEEEE; border: black 1px dashed; line-height: 100%; padding: 10px;"><br />        push 0.0, 'md5'<br />        new<br />        setRegister r:5<br />        pop<br />        push 'checksum', 'myScore'<br />        getVariable<br />        push 'nonivechey902!0'<br />        add<br />        push r:3, 'fb_sig_user'<br />        getMember<br />        add<br />        toString<br />        push 1, r:5, 'hash'<br />        callMethod<br />        setVariable<br /></pre><br /><br />In pseudocode that would read something like:<br /><pre style="background-color: #EEEEEE; border: black 1px dashed; line-height: 100%; padding: 10px;"><br />checksum = hash(getVariable("myScore") + "nonivechey902!0" + user.getMember("fb_sig_user"), "md5")<br /></pre><br /><br />So, to set my score to 102101 (which is 1 higher than my mom's ;), I generate a new checksum <br />(I used userid 0123456789 in this example)<br /><br /><pre style="background-color: #EEEEEE; border: black 1px dashed; line-height: 100%; padding: 10px;"><br />deepstar@phoenix:/tmp/bej$ echo -n '102101nonivechey902!00123456789' | md5sum<br />e3f37c9eb8c861818c0e4b32265be59d  -<br /></pre><br /><br />Next, I replaced the checksum in the datastream with the one above, and changed the score to 102101. Finally transmitted it to the gameserver and the score was set.